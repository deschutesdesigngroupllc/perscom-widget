(()=>{const e={NODE_ENV:"production",NVM_INC:"/Users/jonerickson/Library/Application Support/Herd/config/nvm/versions/node/v22.15.0/include/node",HERD_PHP_81_INI_SCAN_DIR:"/Users/jonerickson/Library/Application Support/Herd/config/php/81/",NODE:"/Users/jonerickson/Library/Application Support/Herd/config/nvm/versions/node/v22.15.0/bin/node",INIT_CWD:"/Users/jonerickson/Code/perscom-widget",NVM_CD_FLAGS:"-q",TERM:"xterm-256color",SHELL:"/bin/zsh",TMPDIR:"/var/folders/pp/yfzsn6_95q1g2t52q09bjrw40000gn/T/",npm_config_global_prefix:"/Users/jonerickson/Library/Application Support/Herd/config/nvm/versions/node/v22.15.0",COLOR:"1",TERM_SESSION_ID:"ace92b96-d7e4-41db-9d13-6423953ba00e",npm_config_noproxy:"",npm_config_local_prefix:"/Users/jonerickson/Code/perscom-widget",HERD_PHP_83_INI_SCAN_DIR:"/Users/jonerickson/Library/Application Support/Herd/config/php/83/",ZSH:"/Users/jonerickson/.oh-my-zsh",NVM_DIR:"/Users/jonerickson/Library/Application Support/Herd/config/nvm",USER:"jonerickson",LS_COLORS:"di=1;36:ln=35:so=32:pi=33:ex=31:bd=34;46:cd=34;43:su=30;41:sg=30;46:tw=30;42:ow=30;43",COMMAND_MODE:"unix2003",npm_config_globalconfig:"/Users/jonerickson/Library/Application Support/Herd/config/nvm/versions/node/v22.15.0/etc/npmrc",SSH_AUTH_SOCK:"/private/tmp/com.apple.launchd.adNIRzPU2c/Listeners",__CF_USER_TEXT_ENCODING:"0x1F5:0x0:0x0",npm_execpath:"/Users/jonerickson/Library/Application Support/Herd/config/nvm/versions/node/v22.15.0/lib/node_modules/npm/bin/npm-cli.js",HERD_PHP_82_INI_SCAN_DIR:"/Users/jonerickson/Library/Application Support/Herd/config/php/82/",PAGER:"less",LSCOLORS:"Gxfxcxdxbxegedabagacad",PATH:"/Users/jonerickson/Code/perscom-widget/node_modules/.bin:/Users/jonerickson/Code/node_modules/.bin:/Users/jonerickson/node_modules/.bin:/Users/node_modules/.bin:/node_modules/.bin:/Users/jonerickson/Library/Application Support/Herd/config/nvm/versions/node/v22.15.0/lib/node_modules/npm/node_modules/@npmcli/run-script/lib/node-gyp-bin:/Users/jonerickson/Library/Application Support/Herd/bin:/Users/jonerickson/Library/Application Support/Herd/bin/:/Users/jonerickson/Library/Application Support/Herd/config/nvm/versions/node/v22.15.0/bin:/usr/local/bin:/System/Cryptexes/App/usr/bin:/usr/bin:/bin:/usr/sbin:/sbin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/local/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/bin:/var/run/com.apple.security.cryptexd/codex.system/bootstrap/usr/appleinternal/bin:/Users/jonerickson/Code/perscom-widget/node_modules/.bin",HERD_PHP_84_INI_SCAN_DIR:"/Users/jonerickson/Library/Application Support/Herd/config/php/84/",TERMINAL_EMULATOR:"JetBrains-JediTerm",npm_package_json:"/Users/jonerickson/Code/perscom-widget/package.json",_:"/Users/jonerickson/Code/perscom-widget/node_modules/.bin/webpack",npm_config_userconfig:"/Users/jonerickson/.npmrc",npm_config_init_module:"/Users/jonerickson/.npm-init.js",__CFBundleIdentifier:"com.jetbrains.PhpStorm",npm_command:"run-script",PWD:"/Users/jonerickson/Code/perscom-widget",npm_lifecycle_event:"build",EDITOR:"vi",npm_package_name:"perscom-3.0-widget",npm_config_npm_version:"11.3.0",XPC_FLAGS:"0x0",npm_config_node_gyp:"/Users/jonerickson/Library/Application Support/Herd/config/nvm/versions/node/v22.15.0/lib/node_modules/npm/node_modules/node-gyp/bin/node-gyp.js",npm_package_version:"0.1.0",XPC_SERVICE_NAME:"0",SHLVL:"2",HOME:"/Users/jonerickson",npm_config_cache:"/Users/jonerickson/.npm",LESS:"-R",LOGNAME:"jonerickson",npm_lifecycle_script:"NODE_ENV=production webpack --config webpack.config.js",LC_CTYPE:"UTF-8",NVM_BIN:"/Users/jonerickson/Library/Application Support/Herd/config/nvm/versions/node/v22.15.0/bin",npm_config_user_agent:"npm/11.3.0 node/v22.15.0 darwin x64 workspaces/false",npm_node_execpath:"/Users/jonerickson/Library/Application Support/Herd/config/nvm/versions/node/v22.15.0/bin/node",npm_config_prefix:"/Users/jonerickson/Library/Application Support/Herd/config/nvm/versions/node/v22.15.0"}.API_URL||"https://api.perscom-app.test/v2/widgets/",n="perscom_widget_iframe",o="perscom_widget_wrapper";class i{init=(()=>{var e=this;return function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"roster",o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;e.widget=n,e.apiKey=o,e.initializeIframe().then((()=>{e.mountIframe(),e.setupIframeResizer(),e.setupNavigationListener()}))}})();setupIframeResizer=()=>{if(document.getElementById(n)){const e=document.createElement("script");e.src="https://cdn.jsdelivr.net/npm/@iframe-resizer/parent@5.3.2",e.type="text/javascript",e.onload=()=>{window.iframeResize({log:!1,license:"GPLv3",waitForLoad:!0},`#${n}`)},document.body.appendChild(e)}};initializeIframe=async()=>{if(!document.getElementById(n)&&document.getElementById(o))try{const o=e+this.widget,i=await fetch(e+this.widget,{headers:{Accept:"text/html",Authorization:`Bearer ${this.apiKey}`}});let s;if(i.status>=500||i.headers.get("content-type")?.includes("application/json")){const e=await i.json();s=`<script src="https://cdn.tailwindcss.com"><\/script><div class="text-sm"><div class="font-bold">${e.error.message}</div><ul class="mt-2 list-inside"><li><span class="font-semibold">URL:</span> ${o}</li><li><span class="font-semibold">Request ID:</span> ${e.error.request_id}</li><li><span class="font-semibold">Trace ID:</span> ${e.error.trace_id}</li></ul></div>`}else s=await i.text();const r=new Blob([s],{type:"text/html"}),t=URL.createObjectURL(r),p=document.createElement("iframe");p.src=t,p.id=n,p.crossorigin="anonymous",p.style.width="1px",p.style.minWidth="100%",p.style.background="transparent",p.style.position="relative",p.style.margin=0,p.style.border="none",p.style.overflow="hidden",p.style.display="block",p.style.outline="none",p.style.boxShadow="none",p.style.filter="none",this.iframe=p}catch(e){}};mountIframe=()=>{if(!document.getElementById(n)&&document.getElementById(o)){document.getElementById(o).appendChild(this.iframe)}};setupNavigationListener=()=>{window.addEventListener("message",(e=>{e.data}))};navigate=async n=>{try{const o=await fetch(e+n,{headers:{Accept:"text/html",Authorization:`Bearer ${this.apiKey}`}});let i=await o.text();const s=new Blob([i],{type:"text/html"}),r=URL.createObjectURL(s);this.iframe&&(this.iframe.src=r)}catch(e){}}}(()=>{const e=document.getElementById("perscom_widget");if(!e)return;const n=e.getAttribute("data-widget"),o=e.getAttribute("data-apikey");window.perscom=new i,window.perscom.init(n,o)})()})();
//# sourceMappingURL=widget.js.map